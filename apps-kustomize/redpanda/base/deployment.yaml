apiVersion: apps/v1
kind: Deployment
metadata:
  name: redpanda
  labels:
    app: redpanda
spec:
  replicas: 1
  selector:
    matchLabels:
      app: redpanda
  template:
    metadata:
      labels:
        app: redpanda
    spec:
      containers:
        - name: redpanda
          image: redpandadata/redpanda:latest
          args:
          - redpanda
          - start
          - --overprovisioned
          - --smp 1
          - --memory 1G
          - --reserve-memory 0M
          - --node-id 0
          - --check=false
          - --kafka-addr internal://0.0.0.0:9092
          - --advertise-kafka-addr internal://redpanda.default.svc.cluster.local:9092
          ports:
            - containerPort: 9092  # Default Redpanda port for Kafka API
              name: kafka
            - containerPort: 9644
              name: admin
          volumeMounts:
            - name: redpanda-data
              mountPath: /var/lib/redpanda/data
      volumes:
        - name: redpanda-data
          persistentVolumeClaim:
            claimName: redpanda-data
